version: "3"
services:
  krakend_ce:
    # The :watch image restarts the service automatically hen the configuration files change.
    # Do not use this image in production, it's meant to speed up your testing and development.
    image: devopsfaith/krakend:watch
    container_name: krakend
    volumes:
      - ./config/krakend:/etc/krakend
      - ./krakend-client-example:/opt/krakend/plugins/
    environment:
      - FC_ENABLE=1
      - FC_SETTINGS=/etc/krakend/settings
      - FC_PARTIALS=/etc/krakend/partials
      - FC_TEMPLATES=/etc/krakend/templates
      - FC_OUT=out.json
      - SERVICE_NAME=KrakenD API Gateway
      - SERVICE_NAME2=test
      - ENV=dev
      - AWS_PROFILE=pharmconnect
    ports:
      - "1234:1234"
      - "8080:8080"
      - "8090:8090"
    command: [ "run", "-dc", "/etc/krakend/krakend.tmpl", "" ]
    networks:
      - shared_network
  # rabbitmq:
  #   image: rabbitmq:3-management
  #   ports:
  #     - "15672:15672"
networks:
  shared_network:
    external: true